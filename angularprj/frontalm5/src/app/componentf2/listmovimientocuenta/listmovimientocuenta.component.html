<div class="container col-md-6 mt-4">
  <div class="card shadow-lg border-0 rounded-3">
    <div class="card-header bg-primary text-white text-center">
      <h4 class="mb-0">Registrar Movimiento</h4>
    </div>

    <div class="card-body">
      <form #movForm="ngForm">

        <!-- üîç Buscador de cuenta -->
<div class="form-group mb-4 position-relative">
  <label for="buscarCuenta" class="form-label fw-bold text-primary">
    Buscar Cuenta:
  </label>

  <div class="input-group shadow-sm">
    <span class="input-group-text bg-primary text-white">
      <i class="bi bi-search"></i>
    </span>
    <input
      id="buscarCuenta"
      type="text"
      class="form-control"
      placeholder="Buscar por n√∫mero de cuenta, tipo o nombre..."
      [(ngModel)]="searchCuenta"
      [ngModelOptions]="{ standalone: true }"
      (input)="filtrarCuentas()"
      (focus)="filtrarCuentas()"
      autocomplete="off"
    />
  </div>

  <!-- üí° Lista de sugerencias -->
  <ul
    *ngIf="filteredCuentas.length > 0 && searchCuenta"
    class="list-group position-absolute w-100 border rounded-3 mt-1 shadow"
    style="max-height: 220px; overflow-y: auto; z-index: 10; animation: fadeIn 0.15s ease-in;"
  >
    <li
      *ngFor="let c of filteredCuentas"
      class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
      (click)="seleccionarCuenta(c)"
      style="cursor: pointer;"
    >
      <div>
        <strong>ID Cuenta:</strong> {{ c.idSaldoCuenta }}<br />
        <small class="text-muted">
          {{ c.tipoSaldoCuenta.nombre }} - {{ c.persona.nombre }} {{ c.persona.apellido }}
        </small>
      </div>
      <i class="bi bi-check-circle text-success fs-5"></i>
    </li>
  </ul>

  <!-- ‚úÖ Cuenta seleccionada -->
  <div *ngIf="cuentaSeleccionadaTexto" class="alert alert-info mt-3 py-2">
    <i class="bi bi-wallet2"></i>
    <strong> Seleccionado:</strong> {{ cuentaSeleccionadaTexto }}

    <!-- üí∞ Mostrar saldo actual -->
     <div *ngIf="saldoActual !== null" class="mt-1">
      <i class="bi bi-cash-coin"> </i>
      <strong> Saldo Actual:</strong>
      <span [ngClass]="saldoActual >= 0 ? 'text-success' : 'text-danger'">
        Q {{saldoActual | number: '1.2-2'}}
      </span>
     </div>

  </div>
</div>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>


        <!-- Cuenta Combo
        <div class="form-group mb-3">
          <label class="form-label fw-bold">Cuenta:</label>
          <select
            [(ngModel)]="selectedCuenta"
            name="cuenta"
            class="form-select"
            required
          >
            <option [ngValue]="null" disabled>-- Seleccione una cuenta --</option>
            <option *ngFor="let c of cuentas" [ngValue]="c.idSaldoCuenta">
              {{ c.idSaldoCuenta }} - {{ c.tipoSaldoCuenta.nombre}} - {{ c.persona.nombre }} {{ c.persona.apellido }}
            </option>
          </select>
        </div>-->

        <!-- Tipo de Movimiento -->
        <div class="form-group mb-3">
          <label class="form-label fw-bold">Tipo de Movimiento:</label>
          <select
            [(ngModel)]="selectedTipoMovimiento"
            name="tipo"
            class="form-select"
            required
          >
            <option [ngValue]="null" disabled>-- Seleccione tipo --</option>
            <option
              *ngFor="let t of tiposMovimiento"
              [ngValue]="t.idTipoMovimientoCXC"
            >
              {{ t.nombre }}
            </option>
          </select>
        </div>

        <!-- Valor Movimiento -->
        <div class="form-group mb-3">
          <label class="form-label fw-bold">Valor del Movimiento:</label>
          <input
            type="number"
            [(ngModel)]="movimiento.valorMovimiento"
            name="valorMovimiento"
            class="form-control"
            required
            placeholder="Ingrese monto del movimiento"
          />
        </div>

        <!-- Descripci√≥n -->
        <div class="form-group mb-3">
          <label class="form-label fw-bold">Descripci√≥n:</label>
          <input
            type="text"
            [(ngModel)]="movimiento.descripcion"
            name="descripcion"
            class="form-control"
            required
            placeholder="Ingrese descripci√≥n del movimiento"
          />
        </div>

        <!-- Generado Autom√°ticamente -->
        <div class="form-check mb-3">
          <input
            type="checkbox"
            [(ngModel)]="movimiento.generadoAutomaticamente"
            name="generadoAutomaticamente"
            class="form-check-input"
          />
          <label class="form-check-label">Generado Autom√°ticamente</label>
        </div>

        <!-- Botones -->
        <div class="d-flex justify-content-end">
          <button
            type="button"
            class="btn btn-success me-2"
            (click)="guardarMovimiento()"
          >
            Guardar
          </button>
          <button type="button" class="btn btn-danger" (click)="cancelar()">
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

