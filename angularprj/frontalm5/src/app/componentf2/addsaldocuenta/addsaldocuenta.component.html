<div class="container col-md-6 mt-4">
  <div class="card shadow-lg border-0 rounded-3">
    <!-- Header -->
    <div class="card-header bg-primary text-white text-center rounded-top">
      <h3 class="mb-0">Agregar Cuenta</h3>
    </div>

    <!-- Body -->
    <div class="card-body">
      <form #cuentaForm="ngForm" novalidate>

        <!-- üîç Buscador de persona con estilo moderno -->
<div class="form-group mb-4 position-relative">
  <label for="buscarPersona" class="form-label fw-bold text-primary"
    >Buscar Persona:</label
  >

  <div class="input-group shadow-sm">
    <span class="input-group-text bg-primary text-white">
      <i class="bi bi-search"></i>
    </span>
    <input
      id="buscarPersona"
      type="text"
      class="form-control"
      placeholder="Buscar por nombre, apellido o ID..."
      [(ngModel)]="searchTerm"
      [ngModelOptions]="{ standalone: true }"
      (input)="filtrarPersonas()"
      (focus)="filtrarPersonas()"
      autocomplete="off"
    />
  </div>

  <!-- üí° Lista de sugerencias -->
  <ul
    *ngIf="filteredPersonas.length > 0 && searchTerm"
    class="list-group position-absolute w-100 border rounded-3 mt-1 shadow"
    style="max-height: 220px; overflow-y: auto; z-index: 10; animation: fadeIn 0.15s ease-in;"
  >
    <li
      *ngFor="let p of filteredPersonas"
      class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
      (click)="seleccionarPersona(p)"
      style="cursor: pointer;"
    >
      <div>
        <strong>{{ p.nombre }} {{ p.apellido }}</strong><br />
        <small class="text-muted">ID: {{ p.idPersona }}</small>
      </div>
      <i class="bi bi-person-check text-success fs-5"></i>
    </li>
  </ul>

  <!-- ‚úÖ Persona seleccionada -->
  <div *ngIf="personaSeleccionadaTexto" class="alert alert-info mt-3 py-2">
    <i class="bi bi-person-fill"></i>
    <strong>Seleccionado:</strong> {{ personaSeleccionadaTexto }}
  </div>
</div>

<!-- üí´ Peque√±a animaci√≥n -->
<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>


        <!-- Buscador de persona
        <div class="form-group mb-3 position-relative">
          <label for="buscarPersona" class="form-label fw-bold"
            >Buscar Persona:</label
          >
          <input
            id="buscarPersona"
            type="text"
            class="form-control"
            placeholder="Buscar por nombre, apellido o ID"
            [(ngModel)]="searchTerm"
            [ngModelOptions]="{ standalone: true }"
            (input)="filtrarPersonas()"
            (focus)="filtrarPersonas()"
          />-->

          <!-- Lista de sugerencias
          <ul
            *ngIf="filteredPersonas.length > 0 && searchTerm"
            class="list-group position-absolute w-100 shadow-sm"
            style="max-height: 200px; overflow-y: auto; z-index: 10"
          >
            <li
              *ngFor="let p of filteredPersonas"
              class="list-group-item list-group-item-action"
              (click)="seleccionarPersona(p)"
            >
              {{ p.idPersona }} - {{ p.nombre }} {{ p.apellido }}
            </li>
          </ul>-->

          <!-- Persona seleccionada
          <div *ngIf="personaSeleccionadaTexto" class="mt-2 text-muted">
            <strong>Seleccionado:</strong> {{ personaSeleccionadaTexto }}
          </div>
        </div>-->

        <!-- Persona Combo
        <div class="form-group mb-3">
          <label for="persona" class="form-label fw-bold">Persona:</label>
          <select
            [(ngModel)]="selectedPersona"
            name="persona"
            id="persona"
            class="form-select"
            required
          >
            <option [ngValue]="null" disabled>-- Seleccione una persona --</option>
            <option *ngFor="let p of persona" [ngValue]="p.idPersona">
              {{ p.idPersona +" - "}} {{ p.nombre }} {{p.apellido}}
            </option>
          </select>
        </div>-->

        <!--
        <div class="form-group mb-3">
          <label for="persona" class="form-label fw-bold">Persona:</label>
          <input
            type="text"
            class="form-control"
            placeholder="Ingrese ID o nombre de la persona"
            [(ngModel)]="personaBusqueda"
            name="personaBusqueda"
            (input)="buscarPersona()"
          />-->

        <!-- Resultados
          <ul class="list-group mt-2" *ngIf="personasFiltradas.length > 0">
            <li
              class="list-group-item list-group-item-action"
              *ngFor="let p of personasFiltradas"
              (click)="seleccionarPersona(p)"
            >
              {{ p.idPersona }} - {{ p.nombre }} {{ p.apellido }}
            </li>
          </ul>
        </div>-->

        <!-- Input de b√∫squeda
        <div class="form-group mb-3" >
          <label for="persona" class="form-label fw-bold">Persona:</label>
          <input
            type="text"
            class="form-control"
            placeholder="Ingrese ID o nombre de la persona"
            [(ngModel)]="personaBusqueda"
            name="personaBusqueda"
            (input)="buscarPersona()"
          />-->

        <!-- Resultados
          <ul class="list-group mt-2" *ngIf="personasFiltradas.length > 0">
            <li
              class="list-group-item list-group-item-action"
              *ngFor="let p of personasFiltradas"
              (click)="seleccionarPersona(p)"
            >
              {{ p.idPersona }} - {{ p.nombre }} {{ p.apellido }}
            </li>
          </ul>
        </div>-->

        <!-- Tipo de Cuenta -->
        <div class="form-group mb-3">
          <label for="tipo" class="form-label fw-bold">Tipo de Cuenta:</label>
          <select
            [(ngModel)]="selectedTipoSaldoCuenta"
            name="tipo"
            id="tipo"
            class="form-select"
            required
          >
            <option [ngValue]="null" disabled>
              -- Seleccione tipo de cuenta --
            </option>
            <option
              *ngFor="let t of tipoCuenta"
              [ngValue]="t.idTipoSaldoCuenta"
            >
              {{ t.nombre }}
            </option>
          </select>
        </div>

        <!-- Status de Cuenta -->
        <div class="form-group mb-3">
          <label for="status" class="form-label fw-bold"
            >Estado de Cuenta:</label
          >
          <select
            [(ngModel)]="selectedStatusCuetna"
            name="status"
            id="status"
            class="form-select"
            required
          >
            <option [ngValue]="null" disabled>
              -- Seleccione estado de cuenta --
            </option>
            <option *ngFor="let s of status" [ngValue]="s.idStatusCuenta">
              {{ s.nombre }}
            </option>
          </select>
        </div>

        <!-- Saldos -->
        <div class="form-group mb-3">
          <label for="saldoAnterior" class="form-label fw-bold"
            >Saldo Anterior:</label
          >
          <input
            [(ngModel)]="saldoCuenta.saldoAnterior"
            type="number"
            name="saldoAnterior"
            id="saldoAnterior"
            class="form-control"
            placeholder="Ingrese saldo anterior"
            required
          />
        </div>

        <div class="form-group mb-3">
          <label for="debitos" class="form-label fw-bold">D√©bitos:</label>
          <input
            [(ngModel)]="saldoCuenta.debitos"
            type="number"
            name="debitos"
            id="debitos"
            class="form-control"
            placeholder="Ingrese d√©bitos"
            required
          />
        </div>

        <div class="form-group mb-3">
          <label for="creditos" class="form-label fw-bold">Cr√©ditos:</label>
          <input
            [(ngModel)]="saldoCuenta.creditos"
            type="number"
            name="creditos"
            id="creditos"
            class="form-control"
            placeholder="Ingrese cr√©ditos"
            required
          />
        </div>

        <!-- Botones -->
        <div class="d-flex justify-content-end">
          <button
            (click)="guardar()"
            type="button"
            class="btn btn-outline-success me-2"
            [disabled]="!cuentaForm.form.valid || !selectedPersona"
          >
            Guardar
          </button>

          <button
            (click)="Cancelar()"
            type="button"
            class="btn btn-outline-danger"
          >
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
